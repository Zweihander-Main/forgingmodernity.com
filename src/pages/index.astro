---
import { getCollection } from 'astro:content';
import Global from '@layouts/Global.astro';
import Parallax from '@layouts/partial/Parallax.astro';
import Parchment from '@layouts/partial/Parchment.astro';
import Hero from '@components/Hero/index.astro';
import BookOverview from '@components/BookOverview/index.astro';
import { getEntryBySlug } from 'astro:content';
export type Props = Record<string, never>;

const metaEntry = await getEntryBySlug('meta', 'site');
const { shortTitle, subTitle } = metaEntry.data;

const bookInfo = await getEntryBySlug('index', 'bookoverview');
if (!bookInfo) {
	throw new Error('No book overview item found');
}

const reviewsInfo = await getEntryBySlug('index', 'reviews');
if (!reviewsInfo) {
	throw new Error('No reviews item found');
}

const footerItems = await getCollection('syndication');
---

<Global title={`${shortTitle}: ${subTitle}`}>
	<Parallax>
		<Hero slot="hero" title={shortTitle} subTitle={subTitle} />
		<Parchment slot="cover">
			<BookOverview
				bookInfo={bookInfo}
				reviewsInfo={reviewsInfo}
				footerItems={footerItems}
			/>
		</Parchment>
	</Parallax>
</Global>

<style lang="scss"></style>
